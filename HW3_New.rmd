---
Title: "HW3 Group 1"
author: "Megan Valmidiano & Namit Shrivastava"
date: "2024-09-17"
output: pdf_document
---

This exercise involves the Boston housing data set. Assume that we are interested in per
capita crime rate, crim.

```{r}
library(MASS)
library(tidyverse)
library(ggplot2)
data(Boston)
```
So before we start examining, we load the required libraries and load the Boston dataset

A. Examine crim with summary() and in a histogram.
```{r}
summary(Boston$crim)
ggplot(Boston, aes(x = crim)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  labs(title = "Histogram of Crime Rate (crim)",
       x = "Crime Rate", y = "Frequency")
```
The histogram shows that the distribution of crime rates is heavily right-skewed, 
with most suburbs in Boston having low crime rates and a few suburbs with very high crime rates.

B. Focus on suburbs with the crime rate above 25. How many suburbs fall into this group?
What are the pupil-teacher ratios like in those suburbs? How about property tax rates? How
about median home values? How do the pupil-teacher ratios, property tax rates and median
home values compare between these suburbs and the remaining suburbs?
```{r}
high_crime_suburbs <- Boston %>% filter(crim > 25)
high_crime_suburbs
n_high_crime <- nrow(high_crime_suburbs)
n_high_crime
```
Number of suburbs with crime rate above 25 comes out to be 11.
```{r}
summary(high_crime_suburbs$ptratio)
summary(high_crime_suburbs$tax)
summary(high_crime_suburbs$medv)
```
So the Pupil-teacher ratios, property tax rates and median home values for suburbs with crime rate above 25 are given by
the above summary.

Now Comparison between high-crime suburbs and others is given by:
```{r}
comparison <- data.frame(
  Group = c("High Crime", "Others"),
  Count = c(n_high_crime, nrow(Boston) - n_high_crime),
  Avg_PTRatio = c(mean(high_crime_suburbs$ptratio), mean(Boston$ptratio[Boston$crim <= 25])),
  Avg_TaxRate = c(mean(high_crime_suburbs$tax), mean(Boston$tax[Boston$crim <= 25])),
  Median_Value = c(median(high_crime_suburbs$medv), median(Boston$medv[Boston$crim <= 25]))
)
print(comparison)
```
The analysis reveals notable percentage differences between high-crime suburbs and other suburbs:

-The pupil-teacher ratio (PTRatio) in high-crime suburbs is approximately 9.68% higher than in other suburbs.
-Property tax rates in high-crime suburbs are significantly higher, about 65.46% more than in other areas.
-Median home values in high-crime suburbs are 58.88% lower compared to other suburbs.

These results suggest that high-crime areas tend to have higher pupil-teacher ratios and tax rates but significantly lower home values, 
indicating less investment in housing and potentially in education, which could be associated with the higher crime rates.

C. Create a scatter plot of the crime rates and the median home values for 1) all suburbs, 2)
suburbs bounding Charles River, and 3) suburbs not bounding Charles River. What do you
observe?

1) All suburbs
```{r}
plot(Boston$crim, Boston$medv, main="Crime Rates vs. Median Home Values", xlab="Crime Rate", ylab="Median Home Value", col="blue")
```
So we are declaring chas variable (1 = bounds river, 0 = does not bound river)
2) Suburbs bounding Charles River
```{r}
plot(subset(Boston, chas == 1)$crim, subset(Boston, chas == 1)$medv, main="Crime Rates vs. Median Home Values (Charles River)", xlab="Crime Rate", ylab="Median Home Value", col="green")
```
3) Suburbs not bounding Charles River
```{r}
plot(subset(Boston, chas == 0)$crim, subset(Boston, chas == 0)$medv, main="Crime Rates vs. Median Home Values (Not Charles River)", xlab="Crime Rate", ylab="Median Home Value", col="red")
```
So from the plots, it seems that All suburbs and suburbs not bounding Charles river have
a common pattern i.e. there appears to be a negative relationship between crime rates and median home values.
As home values increase, crime rates tend to decrease. However, for suburbs bounding Charles river, there seems to be a sparse distribution
and we can't say anything conclusively.

D. Analyze the crime rates as a function of median home values in a simple linear regression
with an intercept. Report what the regression coefficients mean in lay terms.

Alright so for this we have

E. Calculate the coefficients reported in D as well as their standard errors by hand.
F. Create a scatter plot of the crime rates and the median home values with a regression line.
Is the regression line a good summary of the crime rates? Examine residuals to assess this.