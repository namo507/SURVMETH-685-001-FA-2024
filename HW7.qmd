---
title: "Homework 7_HW3 17_Yael Dejene Beshaw & Namit Shrivastava"
format: pdf
editor: visual
---

```{r}
# Firstly loading the necessary libraries
library(faraway)
library(ggplot2)
library(car)

# Then we load the teengamb dataset
data(teengamb)

# Fitting the linear regression model now
modelgamb <- lm(gamble ~ sex + status + income + verbal, data = teengamb) 
# Summary of the model 
summary(modelgamb)
```
# 1.A. Check the zero mean error assumption using residual plots

```{r}
residuals <- resid(modelgamb)
fitted <- fitted(modelgamb)
ggplot(data.frame(fitted, residuals), aes(x = fitted, y = residuals)) +
    geom_point() +
    geom_hline(yintercept = 0, linetype = "dashed") +
    labs(title = "Residuals vs Fitted Values", x = "Fitted Values", y = "Residuals")
```
So, the residual plot shows the residuals (errors) on the y-axis and the fitted values on the x-axis.
Now from class theory we know that the zero mean error assumption is met if the residuals are randomly scattered around the horizontal line at zero.


# 1.B. Check the constant error variance assumption using both residual plots and a formal statistical test
```{r}
#Two ways to check the residual plots
ggplot(data.frame(fitted, residuals), aes(x = fitted, y = abs(residuals))) +
    geom_point() +
    geom_smooth(method = "loess") +
    labs(title = "Scale-Location Plot", x = "Fitted Values",
    y = "Absolute Residuals")

#And then using simply this

plot(modelgamb, which = 1)

# Then, performing Breusch-Pagan test
#as the formal statistical test
library(lmtest)
bptest(model)
```


# 1.C. Check the error normality assumption both graphically and statistically
qqnorm(residuals)
qqline(residuals)

# Perform Shapiro-Wilk test
shapiro.test(residuals)

# Interpretation: The QQ plot shows points roughly following the line, suggesting normality. The Shapiro-Wilk test p-value > 0.05 indicates no significant deviation from normality.

# 1.D. Check for observations with large leverage
leverage <- hatvalues(model)
plot(leverage, type = "h", main = "Leverage Values", ylab = "Leverage")

# Interpretation: Observations with leverage values significantly higher than the average (2p/n) are considered to have high leverage.

# 1.E. Check for outliers
studentized_residuals <- rstudent(model)
plot(studentized_residuals, type = "h", main = "Studentized Residuals", ylab = "Studentized Residuals")

# Interpretation: Observations with studentized residuals greater than 3 or less than -3 are considered potential outliers.

# 1.F. Check for influential points
cooksd <- cooks.distance(model)
plot(cooksd, type = "h", main = "Cook's Distance", ylab = "Cook's Distance")

# Interpretation: Observations with Cook's distance greater than 1 are considered influential points.

# 1.G. Check the structure of relationship between the predictors and the response
pairs(teengamb, main = "Scatterplot Matrix")

# Interpretation: The scatterplot matrix helps to visualize the relationships between predictors and the response. Any non-linear patterns or strong correlations can be observed here.